# ES File Explorer Open Port Vulnerability (CVE-2019-6447)

If you are using the ES File Explorer on your Android phone you were just exposed to a huge vulnerability. It is fixed now (update your device!), but customers of the PRO version still seem to be exposed. What was the problem? Let's have a look!

### ES File Explorer

The ES File Explorer is one of the most commonly used external File Management Applications for Android. It can be used to manage files, apps, cloud services and allows you to access your phone storage via Wi-Fi from another device. It was downloaded over 100 Million times and had a major security issue in version 4.1.9.7.4.]

![alt](https://github.com/sbleh/wireshark_presentation/blob/master/Screenshot_20190313-125251.jpg?raw=true)

## CVE-2019-6447 Vulnerability

The vulnerability CVE-2019-6447 was published by a hacker with the alias *fs0c131y* and has a CVE v3.0 score of 8.1. A hacker can have access to files or execute applications on the victims phone if he is in the same local network.

Every time a user launches ES File Explore a **hidden HTTP server starts** as well. This server opens **port 59777** locally:

```
angler:/ # netstat -ap | grep com.estrongs
tcp6       0      0 :::59777                :::*                    LISTEN      5696/com.estrongs.android.pop
```

Furthermore, the server **accepts JSON payloads from unauthenticated sources**:

```
curl --header "Content-Type: application/json" --request POST --data '{"command":"[my_awesome_cmd]"}' http://192.168.0.8:59777
```

This allows attackers to gain access of and control over confidential data on the victimâ€™s phone. The HTTP server is accessible to everybody in the local network and even remains open after the app is closed.


# What can be exploited? - Rajat
- possible exploits? (screenshot of program)
Succesfull exposure of this vulnerability can result in the disclosure of sensitive information as follows :-
    List all the files in the sdcard in the victim device
    List all the pictures in the victim device
    List all the videos in the victim device
    List all the audio files in the victim device
    List all the apps installed in the victim device
    List all the system apps installed in the victim device
    List all the phone apps installed in the victim device
    List all the apk files stored in the sdcard of the victim device
    List all the apps installed in the victim device
    Get device info of the victim device
    Pull a file from the victim device
    Launch an app of your choice
    Get the icon of an app of your choice
    - CVE score 8.1 explain

# CVE score of CVE-2019-6447 - Rajat


## Tutorial of the Exploit - Lavesh
- access the device
- list apps/open app
- download a picture

## Comments and Conclusion - Khushali

- fixed now (update)
- twitter 
- http vulnerability found afterwards
- on purpose? (twitter discussion ...)
